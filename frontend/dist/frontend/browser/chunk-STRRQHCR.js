import{a as w}from"./chunk-73LEPLIL.js";import{h as D,i as oe}from"./chunk-7WI3RWCC.js";import{$ as h,$a as R,A as g,B as u,Ca as A,E as B,Ea as q,Fa as G,G as p,H as f,La as z,M as T,Ma as H,Na as J,O as x,Oa as K,Pa as Q,Qa as X,Ra as Y,Sa as Z,Ta as $,Ua as ee,V as o,Va as te,W as r,Wa as ne,X as S,Xa as ie,Y as I,Za as _,aa as j,ga as m,ha as v,ia as V,ja as y,ka as E,la as b,q as M,sa as U,ta as W,v as C,va as k,w as F,ya as L,za as N}from"./chunk-RE62KFFJ.js";function de(s,n){if(s&1&&(o(0,"option",16),m(1),r()),s&2){let a=n.$implicit;x("ngValue",a.name),p(),v(a.name)}}var P=(()=>{let n=class n{constructor(e,t){this.expenseService=e,this.router=t,this.formType="Create",this.expense={amount:0,description:"",category:{id:0,name:""},date:new Date().toISOString().split("T")[0]},this.categories=[],this.afterExpenseCreateEvent=new B}predictCategory(e){this.expenseService.predictCategory(e).subscribe(t=>{t.category!="Unknown"&&(this.predictedCategory=t.category,this.expense.amount=t.amount)})}createExpense(){if(this.predictedCategory){let e=this.categories.find(t=>t.name===this.predictedCategory);e&&(this.expense.category=e)}console.log("expense is ",this.expense),this.expenseService.createExpense(this.expense).subscribe(e=>{console.log("Expense created successfully:",e),this.expense={amount:0,description:"",category:{id:0,name:""},date:new Date().toISOString().split("T")[0]},this.predictedCategory="",this.afterExpenseCreateEvent.emit()})}updateExpense(){this.expenseService.updateExpense(this.expense).subscribe(e=>{console.log("Expense updated successfully:",e),this.router.navigate(["/expenses"])},e=>{console.log("something happend ",e)})}onFormSubmit(){this.formType==="Create"?this.createExpense():this.formType==="Update"&&this.updateExpense()}};n.\u0275fac=function(t){return new(t||n)(f(w),f(_))},n.\u0275cmp=C({type:n,selectors:[["expense-form"]],inputs:{formType:"formType",expense:"expense",categories:"categories"},outputs:{afterExpenseCreateEvent:"afterExpenseCreateEvent"},decls:25,vars:7,consts:[["ExpenseForm","ngForm"],[1,"card","p-4","shadow-lg","bg-light","rounded"],[1,"card-title","text-center","mb-4","text-primary"],[1,"form-container",3,"ngSubmit"],[1,"mb-3"],["for","description",1,"form-label"],["type","text","id","description","name","description","required","",1,"form-control",3,"ngModelChange","input","ngModel"],["for","amount",1,"form-label"],["type","number","id","amount","name","amount","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","category",1,"form-label"],["id","category","name","category","required","",1,"form-select",3,"ngModelChange","ngModel"],["class","dropdown-item",3,"ngValue",4,"ngFor","ngForOf"],["for","date",1,"form-label"],["type","date","id","date","name","date","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-primary"],[1,"dropdown-item",3,"ngValue"]],template:function(t,i){if(t&1){let c=I();o(0,"div",1)(1,"h2",2),m(2),r(),o(3,"form",3,0),h("ngSubmit",function(){return g(c),u(i.onFormSubmit())}),o(5,"div",4)(6,"label",5),m(7,"Description:"),r(),o(8,"input",6),b("ngModelChange",function(l){return g(c),E(i.expense.description,l)||(i.expense.description=l),u(l)}),h("input",function(){return g(c),u(i.predictCategory(i.expense.description))}),r()(),o(9,"div",4)(10,"label",7),m(11,"Amount (INR):"),r(),o(12,"input",8),b("ngModelChange",function(l){return g(c),E(i.expense.amount,l)||(i.expense.amount=l),u(l)}),r()(),o(13,"div",4)(14,"label",9),m(15,"Category:"),r(),o(16,"select",10),b("ngModelChange",function(l){return g(c),E(i.predictedCategory,l)||(i.predictedCategory=l),u(l)}),T(17,de,2,2,"option",11),r()(),o(18,"div",4)(19,"label",12),m(20,"Date:"),r(),o(21,"input",13),b("ngModelChange",function(l){return g(c),E(i.expense.date,l)||(i.expense.date=l),u(l)}),r()(),o(22,"div",14)(23,"button",15),m(24),r()()()()}t&2&&(p(2),V("",i.formType," Expense"),p(6),y("ngModel",i.expense.description),p(4),y("ngModel",i.expense.amount),p(4),y("ngModel",i.predictedCategory),p(),x("ngForOf",i.categories),p(4),y("ngModel",i.expense.date),p(3),V("",i.formType," Expense"))},dependencies:[N,X,$,ee,z,Y,Z,H,J,te,Q,K]});let s=n;return s})();var ge=(s,n,a,e,t,i,c,d,l)=>({badge:!0,"category-badge":!0,"food-badge":s,"grocery-badge":n,"utilities-badge":a,"clothes-badge":e,"commute-badge":t,"health-badge":i,"entertainment-badge":c,"rent-badge":d,"gadgets-badge":l});function ue(s,n){if(s&1){let a=I();o(0,"tr",16)(1,"td",17),m(2),r(),o(3,"td"),m(4),W(5,"currency"),r(),o(6,"td",18)(7,"span",19),m(8),r()(),o(9,"td"),m(10),W(11,"date"),r(),o(12,"td",18)(13,"button",20),h("click",function(){let t=g(a).$implicit,i=j();return u(i.deleteExpense(t.id))}),S(14,"i",21),r(),o(15,"button",22),h("click",function(){let t=g(a).$implicit,i=j();return u(i.updateExpense(t.id))}),S(16,"i",23),r()()()}if(s&2){let a=n.$implicit;p(2),v(a.description),p(2),v(k(5,5,a.amount,"INR")),p(3),x("ngClass",U(11,ge,[a.category.name==="Food",a.category.name==="Grocery",a.category.name==="Utilities",a.category.name==="Clothes",a.category.name==="Commute",a.category.name==="Health",a.category.name==="Entertainment",a.category.name==="Rent",a.category.name==="Gadgets"])),p(),V(" ",a.category.name," "),p(2),v(k(11,8,a.date,"longDate"))}}var pe=(()=>{let n=class n{constructor(e,t){this.expenseService=e,this.router=t,this.expenses=[],this.currentPage=1,this.noOfExpenses=0,this.categories=[],this.sortBy="",this.sortDirection=""}ngOnInit(){this.fetchExpenses(),this.fetchCategories()}fetchExpenses(){this.expenseService.getExpenses(this.currentPage).subscribe(e=>{console.log("Response from paginated ",e),this.expenses=e.results,this.noOfExpenses=e.count})}loadPageData(){this.fetchExpenses()}deleteExpense(e){confirm("Are you sure you want to delete this expense?")&&this.expenseService.deleteExpense(e).subscribe(()=>{console.log("Expense deleted successfully"),this.fetchExpenses()})}updateExpense(e){this.router.navigate(["/expenses/",e])}fetchCategories(){this.expenseService.getCategories().subscribe(e=>{this.categories=e})}ExportExpenses(){console.log("Exporting expenses..."),this.expenseService.ExportExpenses().subscribe(e=>{let t=new Blob([e],{type:"text/csv"}),i=window.URL.createObjectURL(t),c=document.createElement("a");c.href=i,c.download="expenses.csv",document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(i),document.body.removeChild(c)},e=>{console.error("Error exporting expenses:",e)})}};n.\u0275fac=function(t){return new(t||n)(f(w),f(_))},n.\u0275cmp=C({type:n,selectors:[["app-expense-view"]],decls:29,vars:4,consts:[[1,"container-fluid","my-4"],[1,"row"],[1,"col-md-4","mb-4"],["formType","Create",3,"afterExpenseCreateEvent","categories"],[1,"col-md-8"],[1,"card","p-4","shadow-lg","bg-light","rounded"],[1,"card-title","text-center","mb-4","text-primary"],[1,"d-flex","justify-content-end","mb-4"],[1,"btn","btn-success",3,"click"],[1,"table-responsive","mt-4"],[1,"table","table-bordered"],[1,"data-table-header"],["scope","col"],["class","data-table-item",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center"],[3,"pageChange","collectionSize","page"],[1,"data-table-item"],[2,"word-break","break-word"],[1,"text-center"],[3,"ngClass"],["title","Delete",1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["title","Edit",1,"btn","btn-info","mx-2",3,"click"],[1,"fa","fa-edit"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"expense-form",3),h("afterExpenseCreateEvent",function(){return i.fetchExpenses()}),r()(),o(4,"div",4)(5,"div",5)(6,"h2",6),m(7,"Expenses"),r(),o(8,"div",7)(9,"button",8),h("click",function(){return i.ExportExpenses()}),m(10,"Export Expense"),r()(),o(11,"div",9)(12,"table",10)(13,"thead",11)(14,"tr")(15,"th",12),m(16,"Description"),r(),o(17,"th",12),m(18,"Amount"),r(),o(19,"th",12),m(20,"Category"),r(),o(21,"th",12),m(22,"Date"),r(),o(23,"th",12),m(24,"Action"),r()()(),o(25,"tbody"),T(26,ue,17,21,"tr",13),r()(),o(27,"div",14)(28,"ngb-pagination",15),b("pageChange",function(d){return E(i.currentPage,d)||(i.currentPage=d),d}),h("pageChange",function(){return i.loadPageData()}),r()()()()()()()),t&2&&(p(3),x("categories",i.categories),p(23),x("ngForOf",i.expenses),p(2),x("collectionSize",i.noOfExpenses),y("page",i.currentPage))},dependencies:[L,N,D,P,q,A]});let s=n;return s})();var me=(()=>{let n=class n{constructor(e,t,i){this.route=e,this.expenseService=t,this.router=i,this.predictedCategory=""}ngOnInit(){let e=this.route.snapshot.params.expenseId;this.expenseService.getCategories().subscribe(t=>{this.categories=t}),this.expense=this.expenseService.getExpenseByID(e).subscribe(t=>{console.log("Got expense:",t),this.expense=t},t=>{console.error("Theres some error in getting expense:",t)})}updateExpense(){this.expenseService.updateExpense(this.expense).subscribe(e=>{console.log("Expense updated successfully:",e),this.router.navigate(["/expenses"])},e=>{console.log("something happend ",e)})}};n.\u0275fac=function(t){return new(t||n)(f(ie),f(w),f(_))},n.\u0275cmp=C({type:n,selectors:[["app-expense-update"]],decls:2,vars:2,consts:[[1,"container","mt-5"],["formType","Update",3,"categories","expense"]],template:function(t,i){t&1&&(o(0,"div",0),S(1,"expense-form",1),r()),t&2&&(p(),x("categories",i.categories)("expense",i.expense))},dependencies:[P]});let s=n;return s})();var fe=[{path:"",component:pe},{path:":expenseId",component:me}],ce=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=F({type:n}),n.\u0275inj=M({imports:[R.forChild(fe),R]});let s=n;return s})();var Re=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=F({type:n}),n.\u0275inj=M({imports:[G,ne,ce,D,oe]});let s=n;return s})();export{Re as a};
